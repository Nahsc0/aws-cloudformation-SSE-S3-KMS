{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Parameters": {
    "BucketName": {
      "Type": "String",
      "Default": "nasko",
      "Description": "Enter the name for the S3 bucket"
    },
    "EncryptionType": {
      "Type": "String",
      "Description": "Select the encryption type: SSE-S3 or KMS",
      "AllowedValues": ["SSE-S3", "KMS"]
    }
  },
  "Resources": {
    "S3Bucket": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "BucketName": {
          "Ref": "BucketName"
        },
        "BucketEncryption": {
          "Fn::If": [
            "IsSSE-S3",
            {
              "ServerSideEncryptionConfiguration": [
                {
                  "ServerSideEncryptionByDefault": {
                    "SSEAlgorithm": "AES256"
                  }
                }
              ]
            },
            {
              "ServerSideEncryptionConfiguration": [
                {
                  "ServerSideEncryptionByDefault": {
                    "SSEAlgorithm": "aws:kms"
                  }
                }
              ]
            }
          ]
        }
      }
    }
  },
  "Outputs": {
    "BucketNameOutput": {
      "Description": "The name of the created S3 bucket",
      "Value": {
        "Ref": "BucketName"
      }
    },
    "EncryptionTypeOutput": {
      "Description": "The encryption type used for the S3 bucket",
      "Value": {
        "Ref": "EncryptionType"
      }
    }
  }
}
